/*! PPmoney-v4.01 2015-08-12 16:22:56 */function loadInvestRecords(a){$.ajax({type:"GET",cache:!1,url:"/investment/records/"+PrjStatus.prjId+"_"+a+"_"+_page_size,beforeSend:function(){PPLoading(_tbody)},success:function(a){if(hideLoading(_tbody),1!=a.State)return void PPmoney.dialog.quickClose({content:a.Msg});var b="",c=0;if(a.Data.TotalCount>0){var d=a.Data.TotalCount-(a.Data.PageIndex-1)*a.Data.PageSize;$(a.Data.Rows).each(function(a,e){b+="<tr><td>"+d--+"</td><td>"+e.Investor+"</td><td>"+e.Creditor+"</td><td>"+e.Amount+"</td><td>"+e.ApplyTime+"</td><td>"+e.InvestType+"</td></tr>",c+=e.Amount}),$("#recordPagi").html(PPmoneyPagination({pageIndex:a.Data.PageIndex,pageSize:_page_size,totalCount:a.Data.TotalCount,callback:"loadInvestRecords"})),$("#invested-people").html(a.Data.TotalCount),$("#invested-money").html(formatCurrency(PrjAmount.AmountTotal/a.Data.TotalCount))}else b='<tr><td colspan="6"><div class="no-record">æš‚æ— æŠ•èµ„è®°å½•</div></td></tr>';_tbody.html(b)},error:function(){PPLoading(_tbody)}})}function loadMyInfo(a){if(a.Id)$("#span_CustomerAmount").html(a.CustomerAmount>=100?formatCurrency(a.CustomerAmount)+"å…?":formatCurrency(a.CustomerAmount)+'å…?<a href="/Customer/Recharge/" class="recharge" target="_blank">å……å€?</a>'),isLogin=!0,accountType=$("input[name='AccountType']:checked").val(),"1"==accountType?CustomerAmount=Math.floor(a.CustomerAmount):"4"==accountType&&(CustomerAmount=Math.floor(a.DailyBaoAmount)),PrjAmount.minAmount>100&&$investNum.val("1"==PrjAmount.PackageType?PrjAmount.minAmount/100:PrjAmount.minAmount),1==a.HasDailyBaoAccount?($("#span_CustomerDailyBaoAmount").text(formatCurrency(a.DailyBaoAmount)+"å…?"),1==isDisableDailyBao?$("#account-dailybao").attr("disabled",!0):$("#account-dailybao").attr("disabled",!1),$("#dailyBaoTransIn").hide()):($("#account-dailybao").attr("disabled",!0),$("#span_CustomerDailyBaoAmount").hide(),$("#dailyBaoTransIn").show()),$("input[name=AccountType]").on({click:function(){accountType=$("input[name='AccountType']:checked").val(),"1"==accountType?CustomerAmount=Math.floor(a.CustomerAmount):"4"==accountType&&(CustomerAmount=Math.floor(a.DailyBaoAmount)),$(this).is(":checked")&&($("#accountTitle").text($(this).attr("data-tips")),"true"!=PrjStatus.isFinancialFund&&inputState())}});else{var b="<a class='em' href='/login?ReturnUrl=project/commondetail/"+PrjStatus.prjId+"'>è¯·å…ˆç™»å½•</a>";$investBox.find(".my-account-bd").html(b),$("#btnTotal").hide()}}function userInfo(){$.ajax({type:"get",cache:!1,url:"/project/AsyncLoadUserInfo",data:{},beforeSend:function(){PPLoading($investBox)},success:function(a){hideLoading($investBox),loadMyInfo(a),prjStatus()}})}function prjStatus(){$.ajax({type:"get",cache:!1,url:"/project/AsyncLoadPrjStatus/"+PrjStatus.prjId,beforeSend:function(){PPLoading($investBox)},success:function(a){hideLoading($investBox),$investBox.find(".progress-num").text(a.ProgressRate+"%").end().find(".progress-bar").width(a.ProgressRate+"%").end().find("#total-money").html(formatCurrency(a.CirculationMoney)),CirculationMoney=a.CirculationMoney,(newDate((new Date).getTime()+PPmoneyNowTime).getHours()>=23||newDate((new Date).getTime()+PPmoneyNowTime).getHours()<1)&&(isDisableDailyBao=!0,$("#account-dailybao").attr("disabled",!0),$("#dailybaotips").html("æ¯å¤©23:00è‡³æ¬¡æ—¥å‡Œæ™?01:00ä¸èƒ½ç”¨æ—¥åˆ©å®æŠ•èµ„"),$("#dailybaotips").attr("title","å› é“¶è¡Œç³»ç»Ÿç»´æŠ¤æ—¶é—´ï¼Œæ¯å¤©23:00ç‚¹åˆ°æ¬¡æ—¥å‡Œæ™¨01:00ç‚¹ä¹‹é—´è½¬å…¥ï¼Œè½¬å‡ºç›¸å…³æ“ä½œå¯èƒ½å¤±è´¥ï¼?"));var b="",c=!1;if(newDate(a.beginTime).getTime()-newDate((new Date).getTime()+PPmoneyNowTime).getTime()>0)return"true"==PrjStatus.isReservationPrj.toLowerCase()&&newDate(a.beginTime).getTime()-60*PrjStatus._reservationCouponRetainMinutes*1e3<newDate((new Date).getTime()+PPmoneyNowTime).getTime()&&newDate((new Date).getTime()+PPmoneyNowTime).getTime()<newDate(a.beginTime).getTime()?(c=!0,b='<div id="pro-subside1-advance-btn" class="pro-subside1-btn cutdown-c"><div id="prjBtnWait" class="cutdown-time"></div><div id="prjBtn" class="cutdown-btn">æŠ¢æŠ•</div></div>'):(b='<div id="prjBtnWait" class="btn btn-invest btn-wait"></div>',$(".pro-subside1-ft").removeClass("unsubscribe-c")),"true"==PrjStatus.isReservationPrj.toLowerCase()&&(isreservation=!0,$(".pro-subside1-ft").addClass("unsubscribe-c"),$(".pro-subside1-ft .u2-05").click(function(){$(".pro-subside1-ft").removeClass("unsubscribe-c")})),$prjStatusBtn.html(b),showInvest(),void(c||"true"!=PrjStatus.isReservationPrj.toLowerCase()?new PPCountDown({from:(new Date).getTime()+PPmoneyNowTime,to:a.beginTime,refresh:function(a,b){$("#prjBtnWait").html("å€’è®¡æ—? "+b)},callback:function(){prjStatus()}}).start():new PPCountDown({from:(new Date).getTime()+PPmoneyNowTime,to:a.beginTime,refresh:function(a,b){a.totalTime-60*PrjStatus._reservationCouponRetainMinutes<0?a.stop():$("#prjBtnWait").html("å€’è®¡æ—? "+b)},callback:function(){prjStatus()}}).start());if(newDate(a.endTime)<newDate((new Date).getTime()+PPmoneyNowTime)&&a.ProgressRate-100<0)b='<div class="btn btn-invest btn-finish">è¯¥é¡¹ç›®å·²ç»“æŸ</div>';else if(a.ProgressRate-100<0)b='<div id="prjBtn" class="btn btn-invest">ç«‹å³æŠ•èµ„</div>';else if(a.ProgressRate-100==0){b='<div class="btn btn-invest btn-finish">å·²æ»¡é¢?</div>';var d,e=(newDate(a.endTime).getTime()-newDate(a.beginTime).getTime())/60/1e3;d=60>e&&e>0?1>=e?Math.ceil(numFormat(60*e))+"ç§?":Math.ceil(e)+"åˆ†é’Ÿ":"ç«é€?",$("#invested-time").html(d)}else a.isLiuZhuan&&(b='<div class="btn btn-invest btn-finish">æµè½¬</div>');$prjStatusBtn.html(b),showInvest()},error:function(){PPLoading($investBox)}})}function inputState(){var a=[],b=$investNum.val();investFlag=!0,0==$investNum.val().length||("1"==PrjAmount.PackageType?100*$investNum.val():$investNum.val())<Math.min(CirculationMoney,PrjAmount.minAmount)?(investFlag=investFlag&&!1,a.push(PPmoney.config.errico+Math.min(CirculationMoney,PrjAmount.minAmount)+"å…ƒèµ·æŠ?<br>")):(investFlag=investFlag&&!0,a.push(PPmoney.config.corico+Math.min(CirculationMoney,PrjAmount.minAmount)+"å…ƒèµ·æŠ?<br>")),"1"==PrjAmount.PackageType?100*$investNum.val()%PrjStatus.amountBase!=0&&(investFlag=investFlag&&!1,a.push(PPmoney.config.errico+"è¯·è¾“å…?"+PrjStatus.amountBase+"å…ƒçš„æ•´æ•°å€?<br>")):$investNum.val()%PrjStatus.amountBase!=0&&(investFlag=investFlag&&!1,a.push(PPmoney.config.errico+"è¯·è¾“å…?"+PrjStatus.amountBase+"å…ƒçš„æ•´æ•°å€?<br>")),void 0==$("#invitation_code").val()||""!=$("#invitation_code").val()&&null!=$("#invitation_code").val()||(investFlag=investFlag&&!1,a.push(PPmoney.config.errico+"è¯·è¾“å…¥é‚€è¯·ç <br>")),PrjAmount.singleInvestmentAmount-0>0&&(("1"==PrjAmount.PackageType?100*$investNum.val():$investNum.val())-PrjAmount.singleInvestmentAmount>0?(investFlag=investFlag&&!1,a.push(PPmoney.config.errico+"é™æŠ•æ€»é¢"+PrjAmount.singleInvestmentAmount+"å…?<br>")):(investFlag=investFlag&&!0,a.push(PPmoney.config.corico+"é™æŠ•æ€»é¢"+PrjAmount.singleInvestmentAmount+"å…?<br>"))),PrjAmount.maxAmount-0>0&&(("1"==PrjAmount.PackageType?100*$investNum.val():$investNum.val())-PrjAmount.maxAmount>0?(investFlag=investFlag&&!1,a.push(PPmoney.config.errico+"å•æ¬¡é™æŠ•"+PrjAmount.maxAmount+"å…?<br>")):(investFlag=investFlag&&!0,a.push(PPmoney.config.corico+"å•æ¬¡é™æŠ•"+PrjAmount.maxAmount+"å…?<br>"))),/^[0-9]*[1-9][0-9]*$/.test(b)?(investFlag=investFlag&&!0,a.push(PPmoney.config.emico+Arabia_to_Chinese(("1"==PrjAmount.PackageType?100*$investNum.val():$investNum.val())+"")+"<br>")):(investFlag=investFlag&&!1,a.push(PPmoney.config.errico+"è¯·è¾“å…¥æ•´æ•?<br>")),a.push(PPmoney.config.corico+"é¢„è®¡æ”¶ç›Š"+formatCurrency(("1"==PrjAmount.PackageType?100*$investNum.val():$investNum.val())*PrjAmount.rate+"")+"å…?<br>");var c=maxInvestMoney();"1"==PrjAmount.PackageType&&(100*$investNum.val()-CirculationMoney>0&&($investNum.val((c/100).toString().split(".")[0]),inputState(),PPmoney.dialog.quickClose({content:PPmoney.config.errico+"è¶…å‡ºå¯æŠ•é‡‘é¢"})),100*$investNum.val()>CustomerAmount&&(investFlag=investFlag&&!1,a.push(PPmoney.config.errico+"è¶…å‡ºæ‰€é€‰è´¦æˆ·ä½™é¢?<br>"))),"1"!=PrjAmount.PackageType&&($investNum.val()-CirculationMoney>0&&($investNum.val(c.toString().split(".")[0]),inputState(),PPmoney.dialog.quickClose({content:PPmoney.config.errico+"è¶…å‡ºå¯æŠ•é‡‘é¢"})),$investNum.val()>CustomerAmount&&(investFlag=investFlag&&!1,a.push(PPmoney.config.errico+"è¶…å‡ºæ‰€é€‰è´¦æˆ·ä½™é¢?<br>")));var d="";return $.each(a,function(a,b){d+=b}),dialog.get("tipsBox").show($(".invest-bd")[0]).content(d).height(""),investFlag?$investNum.removeClass("invest-num-error"):($investNum.addClass("invest-num-error"),$tipsBox.css({opacity:0,marginLeft:"20px"}).animate({marginLeft:0,opacity:1},100)),investFlag}function showInvest(){$("#prjBtn").on("click",function(){if(!isLogin)return void PPmoney.dialog.showModal({content:'<div class="p-20">'+PPmoney.config.errico+'æ‚¨è¿˜æ²¡ç™»å½•å‘¢ï¼Œç«‹å³å»<a class="em" href="/login?returnurl=project/commondetail/'+PrjStatus.prjId+'">ç™»å½•</a></div>',ok:function(){location.href="/login?returnurl=project/commondetail/"+PrjStatus.prjId}});if(-1==$.inArray(1,PrjStatus.canUseCoupon)&&-1==$.inArray(2,PrjStatus.canUseCoupon)&&-1==$.inArray(3,PrjStatus.canUseCoupon)&&-1==$.inArray(4,PrjStatus.canUseCoupon)&&-1==$.inArray(5,PrjStatus.canUseCoupon)){if(("1"==PrjAmount.PackageType?100*$investNum.val():$investNum.val())-CustomerAmount>0&&"true"!=PrjStatus.isFinancialFund&&1==accountType)return void PPmoney.dialog.showModal({content:'<div class="p-20">'+PPmoney.config.errico+"ä½™é¢ä¸è¶³ï¼Œç«‹å³å»å……å€¼ï¼Ÿ</div>",ok:function(){location.href="/Customer/Recharge/"}});if(("1"==PrjAmount.PackageType?100*$investNum.val():$investNum.val())-CustomerAmount>0&&"true"!=PrjStatus.isFinancialFund&&1!=accountType)return void PPmoney.dialog.showModal({content:'<div class="p-20">'+PPmoney.config.errico+"è¯¥è´¦æˆ·å¯ç”¨ä½™é¢ä¸è¶?</div>"})}return investFlag?(dialog.get("tipsBox").close(),void(myIframe=PPmoney.dialog.iframe({id:"id"+PrjStatus.prjId,title:"ç¡®è®¤ä¿¡æ¯",width:500,url:"/Project/InvestConfirm?PackageId="+PrjStatus.prjId}))):void $tipsBox.css({opacity:0,marginLeft:"20px"}).animate({marginLeft:0,opacity:1},100)}),$("#btnTotal").click(function(){var a=maxInvestMoney();$investNum.val("1"==PrjAmount.PackageType?Math.floor(a/100):a),inputState()})}function closeInvestConfirmDialog(){myIframe.close().remove()}function maxInvestMoney(){var a;return a=isLogin?PrjAmount.maxAmount-0>0?PrjAmount.singleInvestmentAmount-0>0?Math.min(CirculationMoney,PrjAmount.singleInvestmentAmount,PrjAmount.maxAmount,CustomerAmount):Math.min(CirculationMoney,PrjAmount.maxAmount,CustomerAmount):PrjAmount.singleInvestmentAmount-0>0?Math.min(CirculationMoney,PrjAmount.singleInvestmentAmount,CustomerAmount):Math.min(CirculationMoney,CustomerAmount):PrjAmount.maxAmount-0>0?PrjAmount.singleInvestmentAmount-0>0?Math.min(CirculationMoney,PrjAmount.singleInvestmentAmount,PrjAmount.maxAmount):Math.min(CirculationMoney,PrjAmount.singleInvestmentAmount):PrjAmount.singleInvestmentAmount-0>0?Math.min(CirculationMoney,PrjAmount.singleInvestmentAmount):CirculationMoney}function init(){userInfo(),loadInvestRecords(1),$investNum.val("1"==PrjAmount.PackageType?1:100)}var prjDataIndex=0,imgsArr=[],_page_size=6,_tbody=$("#record_panel"),$investBox=$("#pro-subside1-normal"),$investNum=$("#investNum"),$totalMoney=$("#total-money"),CustomerAmount,CirculationMoney,investFlag=!0,$tipsBox,myIframe,$prjStatusBtn=$("#prjStatusBtn"),isLogin=!1,isreservation=!1,accountType=1,isDisableDailyBao=!1;$.ajaxSetup({cache:!1}),!function(){$("#prjImg").find(">div").each(function(a,b){var c=[];$(b).find("img").each(function(a,b){c.push({src:$(b).attr("src"),alt:"undefined"==typeof $(b).attr("alt")?"å›¾ç‰‡":$(b).attr("alt")})}),imgsArr.push({title:$(b).find("h2").html(),content:c})});for(var a in imgsArr){a=imgsArr[a];for(var b='<div class="mod-prove"><h3>'+a.title+'</h3><div class="mod-prove-bd"><ul>',c="",d=0,e=a.content.length;e>d;d++)c+=d%2?'<div class="mod-prove-sub"><h4>'+a.content[d].alt+'</h4><a class="fancybox-thumbs" data-fancybox-group="gallery" href="'+a.content[d].src+'" title="'+a.content[d].alt+'"><img src="'+a.content[d].src+'!121x76" alt="'+a.content[d].alt+'"></a></div>'+(d+1!=e?"</li>":""):'<li class="cf"><div class="mod-prove-sub"><h4>'+a.content[d].alt+'</h4><a class="fancybox-thumbs" data-fancybox-group="gallery" href="'+a.content[d].src+'" title="'+a.content[d].alt+'"><img src="'+a.content[d].src+'!121x76" alt="'+a.content[d].alt+'"></a></div>';b+=c+"</li></ul></div>"+(e>2?'<a href="javascript:void(0)" class="unslider-arrow prev"><span class="caret-l"></span></a><a href="javascript:void(0)" class="unslider-arrow next"><span class="caret-r"></span></a>':"")+"</div>",a.content.length>0&&$(".pro-subside2").append(b)}}(),!function(){$(".pro-tab-item").click(function(){$(this).addClass("active").siblings().removeClass("active");var a=$(this).index(".pro-tab-item");$(".pro-tab-pane").eq(a).addClass("active").siblings().removeClass("active")}),$(".fancybox-thumbs").fancybox({helpers:{title:{type:"inside"}},afterLoad:function(){this.title=this.title+"("+(this.index+1)+"/"+this.group.length+")"}}),$(".pro-subside2 .mod-prove-bd").each(function(a,b){var c=$(b).unslider({speed:200,delay:!1});$(b).parent().find(".unslider-arrow").click(function(){var a=$(this).attr("class").split(" ")[1];c.data("unslider")[a]()})}),defaultImg(".pro-wrap img"),$(".pro-tab-pane-item").find("strong").each(function(a,b){0==$(b).text().length&&$(b).remove()});var a={A:"å€ºåŠ¡çš„æ”¯ä»˜èƒ½åŠ›å’Œé•¿æœŸå€ºåŠ¡çš„å¿è¿˜èƒ½åŠ›è¾ƒå¼ºï¼›ç»è¥å¤„äºè‰¯æ€§å¾ªç¯çŠ¶æ€ï¼›<br>å¿è¿˜å€ºåŠ¡çš„èƒ½åŠ›è¾ƒå¼ºï¼Œè¾ƒæ˜“å—ä¸åˆ©ç»æµç¯å¢ƒçš„å½±å“ï¼Œç›ˆåˆ©èƒ½åŠ›å’Œå¿å€ºèƒ½åŠ›ä¼šäº§ç”Ÿæ³¢åŠ¨ï¼Œè¿çº¦é£é™©è¾ƒä½ï¼›",AA:"å€ºåŠ¡çš„æ”¯ä»˜èƒ½åŠ›å’Œé•¿æœŸå€ºåŠ¡çš„å¿è¿˜èƒ½åŠ›å¾ˆå¼ºï¼›ç»è¥å¤„äºè‰¯æ€§å¾ªç¯çŠ¶æ€ï¼›<br>å¿è¿˜å€ºåŠ¡çš„èƒ½åŠ›å¾ˆå¼ºï¼Œå—ä¸åˆ©ç»æµç¯å¢ƒçš„å½±å“è¾ƒå°ï¼Œè¿çº¦é£é™©å¾ˆä½ï¼›",AAA:"å€ºåŠ¡çš„æ”¯ä»˜èƒ½åŠ›å’Œå€ºåŠ¡çš„å¿è¿˜èƒ½åŠ›å…·æœ‰æœ€å¤§ä¿éšœï¼›<br>å¿è¿˜å€ºåŠ¡çš„èƒ½åŠ›æå¼ºï¼ŒåŸºæœ¬ä¸å—ä¸åˆ©ç»æµç¯å¢ƒçš„å½±å“ï¼Œè¿çº¦é£é™©æä½ï¼?"};PPmoney.dialog.hoverTips({elem:$(".u2-06"),content:'<div class="p-10">'+a[$("#prjLevel").text()]+"</div>"}),dialog({id:"tipsBox",align:"right",quickClose:!1,autofocus:!1}),$tipsBox=$("div[aria-labelledby='title:tipsBox']"),"true"==PrjStatus.isFinancialFund&&$(".pro-subside1-invest").hide().after("<p class='em p-10'>ä»…æ”¯æŒç†è´¢åŸºé‡?</p>")}(),$investNum.on({blur:function(){},keyup:function(){setTimeout(function(){inputState()},20)}});